/**
 * Provides simple intelligent tooltip popups.
 *
 * @package    jQuery
 * @subpackage Elixon Tooltip
 * @author     Daniel Sevcik <sevcik@webdevelopers.cz>
 * @version    1.1
 * @copyright  2011 Daniel Sevcik
 * @since      2011-08-25T07:31:34+0200
 * @access     public
 */
(function(a){var b={getET:function(c){var d=a(this),e;return d.is(".et")?e=d:e=a(this).data("et")||b.init.apply(this,[c]),e?(c&&b.updateContent(e,c),e):(a.error("You cannot call Elixon Toolkit this way!"),a())},init:function(c){var d=a(this),e=a("#et");a("#et").length||(e=a('<div id="et"></div>').appendTo(document.body)),e.next().length&&e.appendTo(document.body);var f=d.data("et");if(!f||!f.length){var g="<span onclick=\"$(this).parent().data('etSrc').et('hide');\" class=\"etCtrl etClose\">Ã—</span>";f=a('<div style="display: none;"></div>').append(g).appendTo(e).click(function(){b.top.apply(a(this).data("etSrc"))}),a(window).add(f).add(d).resize(function(){d.et("align")})}return d.data("et",f),f.data("etSrc",d),b.updateContent(f,c),f.css({visibility:"visible",display:"none"}).data("etGroup",a.trim(c.group)?a.trim(c.group).split(/\s+/):[]).attr("class","et etOff "+(typeof c.fx=="string"?"et"+c.fx.charAt(0).toUpperCase()+c.fx.slice(1)+"Fx ":"")+c.color+" "+c.className+" "+b.classNameByPosition(c.position,c.align))},updateContent:function(b,c){var d=a.isFunction(c.generator)?a(c.generator.apply(b.data("etSrc"))):a(c.content);d.length&&(a("<div></div>").append(a("> *:not(.etCtrl)",b)),b.append(d)),delete c.generator,delete c.content},defaultGenerator:function(){var b=a(this),c=a();return b.is('a[href]:not([href^="javascript:"])')&&(b.attr("href").match(/^#/)&&(c=a(b.attr("href"))),c.length||(c=a("<object></object>").attr("data",b.attr("href")),b.attr("type")&&c.attr("type",b.attr("type")))),c.length||(b.attr("title")&&b.attr("data-title",b.attr("title")).removeAttr("title"),c=a('<div class="title"></div>').text(b.attr("data-title")||b.text())),c},top:function(c){var d=b.getET.apply(this,[c]),e=b.nested(d);d.before(d.nextAll(".et").not(e)),e.appendTo(a("#et"))},show:function(c){var d=b.getET.apply(this,[c]),e=d.data("etGroup");a("#et > .et").each(function(){for(var b=0;b<e.length;b++)if(a.inArray(e[b],a(this).data("etGroup"))!=-1)return a(this).et("hide")}),b.top.apply(this),d.is(".etOff")&&(d.toggleClass("etOn").toggleClass("etOff"),b.align.apply(this,[c]),b.getFX(c).apply(d,[c,!0]),d.animate("zoom: 1",function(){d.removeClass("et").addClass("et")})),b.nested(d).filter(".etInnerOn").removeClass("etInnerOn").appendTo(a("#et")).each(function(){a(this).data("etSrc").et("show")})},hide:function(c){var d=b.getET.apply(this,[c]),e=d.data("etSrc");d.is(".etOn")&&(d.toggleClass("etOn").toggleClass("etOff"),b.getFX(c).apply(d,[c,!1])),b.nested(d).filter(".etOn").addClass("etInnerOn").each(function(){a(this).data("etSrc").et("hide")})},toggle:function(a){var c=b.getET.apply(this,[a]);b[c.is(".etOn")?"hide":"show"].apply(this,[a])},nested:function(b){return a("#et > .et").filter(function(){return a(this).data("etSrc").closest(".et").is(b)})},showFX:function(b,c){c?a(this).show():a(this).hide()},fadeFX:function(b,c){c?a(this).fadeIn():a(this).fadeOut()},slideFX:function(b,c){c?a(this).slideDown():a(this).slideUp()},getFX:function(c){return a.isFunction(c.fx)?c.fx:typeof c.fx=="string"&&a.isFunction(b[c.fx+"FX"])?b[c.fx+"FX"]:(a.error("Unknown effect: ("+typeof c.fx+") "+c.fx),function(){a.error("Elixon Tooltip: Unsupported FX")})},align:function(a){var c=b.getET.apply(this,[a]),d=c.data("etSrc"),e=!a.position||a.position=="auto",f=!a.align||a.align=="auto";if(e){var g=b.getPositionHint(d,{bottom:".etBottom",top:".etTop",right:".etRight",left:".etLeft",auto:".etAuto"});g||(g=d.is(":input")?["left","right","bottom","top"]:["bottom","top","right","left"])}else var g=[a.position];if(f){var h=b.getPositionHint(d,{center:".etCenter",end:".etEnd",start:".etStart",auto:".etAuto"});h||(h=["center","end","start"])}else var h=[a.align];var i;for(var j=0;j<g.length;j++)for(var k=0;k<h.length;k++){var l=b.coord.apply(this,[g[j],h[k]]);l.position=g[j],l.align=h[k],l.weight=c.is(".etOn")&&g.length+h.length>2?b.positionWeight(c,l):100;if(!i||i.weight<l.weight)i=l}c.css({left:i.left,top:i.top}).removeClass("etBottom etRight etLeft etTop etCenter etStart etEnd").addClass(b.classNameByPosition(i.position,i.align))},getPositionHint:function(a,b){var c=[];for(var d in b)c.push(b[d]);var e=a.closest(c.join(", ")).not(".et");if(!e.length)return!1;for(var d in b)if(e.is(b[d]))return d=="auto"?!1:[d]},classNameByPosition:function(a,b){return"et"+a.charAt(0).toUpperCase()+a.slice(1)+" "+"et"+b.charAt(0).toUpperCase()+b.slice(1)},positionWeight:function(b,c){var d=0,e=b.data("etSrc"),f=e.closest("form"),g=[[a(window),400],[a(".etOn").not(b),-150],[a(":input:visible.error, :button:visible.error",f).not(e),-100],[a(":input:visible, :button:visible",f).not(".error").not(e),-150],[a('label:visible[for="'+e.attr("id")+'"]',f).not(e),-250],[a("img:visible").not(e),-10]];for(var h=0;h<g.length;h++){var i=g[h][0],j=g[h][1];i.each(function(){var b=a(this),e=b.offset()||{left:b.scrollLeft(),top:b.scrollTop()};e.bottom=e.top+b.height(),e.right=e.left+b.width();var f=Math.min(c.right,e.right)-Math.max(c.left,e.left);f<0&&(f=0);var g=Math.min(c.bottom,e.bottom)-Math.max(c.top,e.top);g<0&&(g=0);var h=f*g*j;d+=h})}return d},coord:function(a,c){var d=b.getET.apply(this),e=d.data("etSrc"),f=e.offset(),g=15,h=30,i={visibility:d.css("visibility"),display:d.css("display")};d.css({visibility:"hidden",display:"block"});switch(a){case"top":f.top-=d.outerHeight()+2*g;break;case"right":f.left+=e.outerWidth()+1*g;break;case"bottom":f.top+=e.outerHeight();break;case"left":f.left-=d.outerWidth()+1*g}switch(c+":"+a){case"start:top":case"start:bottom":f.left-=h;break;case"center:bottom":case"center:top":f.left+=e.outerWidth()/2-d.outerWidth()/2;break;case"end:top":case"end:bottom":f.left+=e.outerWidth()-d.outerWidth()+h;break;case"start:right":case"start:left":f.top-=h;break;case"center:right":case"center:left":f.top+=e.outerHeight()/2-d.outerHeight()/2;break;case"end:right":case"end:left":f.top+=e.outerHeight()-d.outerHeight()+h}return d.css({visibility:i.visibility,display:i.display}),{left:f.left,top:f.top,right:f.left+d.outerWidth(),bottom:f.top+d.outerHeight()}}};a.fn.et=function(){var c={options:{}};a.each(arguments,function(d,e){var f=typeof e;f=="string"?b[e]||e=="defaults"?c.method=e:e.match(/^hover|click|focus|blur$/)?(c.toggle=e,c.method||(c.method="init")):c.content=e:a.isPlainObject(e)?c.options=e:a.isFunction(e)?c.generator=e:typeof e=="object"?c.content=e:typeof e=="number"?c.duration=e:a.error("Unknown argument #"+d+": "+typeof e)});var d={};return a.extend(d,a.fn.et.defaults.options||{},c.options),a.extend(c,a.fn.et.defaults||{}),c.options=d,c.method=="defaults"?(delete c.method,a.extend(a.fn.et.defaults,c),this):(!c.method&&(c.generator||c.content)&&(c.method="show"),this.each(function(){var d=a(this).is(".et")?a(this).data("etSrc"):a(this),e=d.data("etSettings")||{method:"show",content:!1,generator:b.defaultGenerator,color:"dark",fx:"fade",position:"auto",align:"auto",className:"",group:"",toggle:!1,duration:0};a.extend(e,c,c.options),delete e.options,e.content!==!1&&delete e.generator,typeof e.content=="string"&&(e.content=a(e.content)),b[e.method].apply(this,[e]),e.duration&&e.method=="show"?(clearTimeout(e.durationTimeout),e.durationTimeout=setTimeout(function(){d.et("hide")},e.duration)):e.method=="hide"&&clearTimeout(e.durationTimeout),e.toggle=="click"&&d.is("a[href]")?d[e.toggle](function(){return a(this).et("toggle"),!1}):e.toggle&&d[e.toggle](function(){a(this).et("toggle")}),delete e.toggle,d.data("etSettings",e)}))},a.fn.et.defaults={options:{}}})(jQuery)